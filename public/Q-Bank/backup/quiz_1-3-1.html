<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4단원: 지구 시스템 - 통합과학 퀴즈</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen flex flex-col">

    <!-- 헤더 -->
    <header class="bg-indigo-600 text-white p-4 shadow-md z-10 shrink-0">
        <div class="max-w-2xl mx-auto flex justify-between items-center">
            <h1 class="text-lg font-bold flex items-center gap-2">
                <i class="fas fa-globe-asia"></i> 4. 지구 시스템 (랜덤 10문항)
            </h1>
            <a href="index.html" class="text-xs bg-indigo-500 hover:bg-indigo-400 px-3 py-1 rounded-full transition">
                <i class="fas fa-home"></i> 홈으로
            </a>
        </div>
    </header>

    <!-- 메인 컨텐츠 영역 -->
    <main class="flex-1 overflow-y-auto p-4 flex items-start justify-center">
        <div id="quiz-container" class="w-full max-w-2xl bg-white rounded-2xl shadow-xl overflow-hidden fade-in min-h-[400px] mb-8 relative">
            
            <!-- 진행 상태 바 -->
            <div class="w-full bg-gray-200 h-2">
                <div id="progress-bar" class="bg-indigo-500 h-2 transition-all duration-300" style="width: 0%"></div>
            </div>

            <!-- 시작 화면 -->
            <div id="start-screen" class="p-8 text-center flex flex-col items-center justify-center h-full min-h-[400px]">
                <div class="w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mb-6 text-3xl text-indigo-600 animate-bounce">
                    <i class="fas fa-layer-group"></i>
                </div>
                <h2 class="text-2xl font-bold mb-2">단원 실전 퀴즈</h2>
                <p class="text-gray-600 mb-8 leading-relaxed">
                    '지구 시스템' 단원 문제 은행(총 30문항)에서<br>
                    <strong class="text-indigo-600">10문제</strong>를 무작위로 추출했습니다.<br>
                    지구의 구조와 판 구조론 등을 점검해보세요!
                </p>
                <button onclick="startQuiz()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-xl transition shadow-lg text-lg flex items-center gap-2 transform hover:scale-105 duration-200">
                    <i class="fas fa-play"></i> 문제 풀기 시작
                </button>
            </div>

            <!-- 문제 영역 -->
            <div id="question-area" class="hidden p-6 md:p-8">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-sm font-bold text-indigo-600 tracking-wider">Q <span id="current-num">1</span> / <span id="total-num">10</span></span>
                    <span id="score-display" class="text-sm font-semibold text-gray-500">0점</span>
                </div>

                <h2 id="question-text" class="text-xl font-bold mb-6 text-gray-800 leading-snug">
                    문제 로딩 중...
                </h2>

                <!-- 힌트 -->
                <div class="mb-6">
                    <button onclick="toggleHint()" class="text-sm text-indigo-500 hover:text-indigo-700 flex items-center gap-1 focus:outline-none transition">
                        <i class="far fa-lightbulb"></i> 힌트 보기
                    </button>
                    <div id="hint-box" class="hidden mt-2 p-3 bg-yellow-50 text-yellow-800 text-sm rounded-lg border border-yellow-200 fade-in">
                        <!-- 힌트 내용 -->
                    </div>
                </div>

                <!-- 보기 리스트 -->
                <div id="options-list" class="space-y-3"></div>

                <!-- 해설 -->
                <div id="rationale-area" class="hidden mt-6 p-4 rounded-xl border fade-in bg-gray-50">
                    <div class="flex items-start gap-3">
                        <div id="rationale-icon" class="text-2xl mt-1 shrink-0"></div>
                        <div>
                            <h3 id="rationale-title" class="font-bold text-lg mb-1"></h3>
                            <p id="rationale-text" class="text-sm leading-relaxed text-gray-700"></p>
                        </div>
                    </div>
                    <button id="next-btn" onclick="nextQuestion()" class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-lg flex justify-center items-center gap-2">
                        다음 문제 <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- 결과 화면 -->
            <div id="result-screen" class="hidden p-8 text-center flex flex-col items-center justify-center h-full min-h-[400px]">
                <div class="w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mb-6 text-4xl text-indigo-600">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2 class="text-3xl font-bold mb-2">퀴즈 완료!</h2>
                <p class="text-gray-600 mb-8">학습이 끝났습니다.</p>
                
                <div class="w-full max-w-sm bg-gray-50 rounded-xl p-6 mb-8 border border-gray-200">
                    <p class="text-sm text-gray-500 mb-1">최종 점수</p>
                    <p class="text-4xl font-bold text-indigo-600"><span id="final-score">0</span> / 100</p>
                </div>

                <div class="flex gap-3 w-full max-w-sm">
                    <button onclick="location.reload()" class="flex-1 bg-white border border-gray-300 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-50 transition">
                        다시 풀기
                    </button>
                    <a href="index.html" class="flex-1 bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 transition flex items-center justify-center">
                        목록으로
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        // ==========================================
        // 4단원 문제 은행 데이터 (30문항)
        // ==========================================
        const questionBank = [
            // [지구 시스템의 구성]
            { question: "지구 시스템의 구성 요소 중 가장 큰 부피를 차지하는 것은?", answerOptions: [{text:"기권",isCorrect:false},{text:"직권(지권)",isCorrect:true,rationale:"지구 반지름은 약 6400km로, 지각, 맨틀, 핵을 포함한 직권이 가장 큰 부피와 질량을 차지합니다."},{text:"수권",isCorrect:false},{text:"생물권",isCorrect:false}], hint: "우리가 밟고 있는 땅과 그 내부입니다." },
            { question: "기권 중 기상 현상(비, 눈, 구름)이 일어나는 층은?", answerOptions: [{text:"대류권",isCorrect:true,rationale:"지표면과 가장 가까운 대류권에는 공기의 대부분과 수증기가 존재하며 활발한 대류 현상이 일어납니다."},{text:"성층권",isCorrect:false},{text:"중간권",isCorrect:false},{text:"열권",isCorrect:false}], hint: "가장 아래에 있는 층입니다." },
            { question: "성층권에 존재하며 자외선을 흡수하여 생명체를 보호하는 층은?", answerOptions: [{text:"오존층",isCorrect:true,rationale:"성층권(높이 약 20~30km)에 있는 오존층은 태양의 유해한 자외선을 흡수합니다."},{text:"전리층",isCorrect:false},{text:"대류층",isCorrect:false},{text:"자기장",isCorrect:false}], hint: "O₃로 이루어져 있습니다." },
            { question: "수권에서 가장 많은 비율을 차지하는 물은?", answerOptions: [{text:"지하수",isCorrect:false},{text:"빙하",isCorrect:false},{text:"해수",isCorrect:true,rationale:"지구상 물의 약 97% 이상은 짠물인 해수입니다."},{text:"강물",isCorrect:false}], hint: "바다에 있는 물입니다." },
            { question: "담수(육지의 물) 중 가장 많은 양을 차지하는 것은?", answerOptions: [{text:"지하수",isCorrect:false},{text:"빙하",isCorrect:true,rationale:"담수 중에서는 빙하가 가장 많고, 그 다음이 지하수입니다."},{text:"호수",isCorrect:false},{text:"하천수",isCorrect:false}], hint: "얼음 상태로 존재합니다." },
            { question: "해수의 층상 구조 중 수심이 깊어질수록 수온이 급격히 낮아지는 층은?", answerOptions: [{text:"혼합층",isCorrect:false},{text:"수온 약층",isCorrect:true,rationale:"혼합층 아래에서 태양 에너지가 도달하지 못해 수심에 따라 수온이 급격히 낮아지는 매우 안정된 층입니다."},{text:"심해층",isCorrect:false},{text:"대류층",isCorrect:false}], hint: "대류가 일어나지 않아 안정한 층입니다." },
            { question: "지권의 층상 구조 중 유일하게 액체 상태로 추정되는 곳은?", answerOptions: [{text:"지각",isCorrect:false},{text:"맨틀",isCorrect:false},{text:"외핵",isCorrect:true,rationale:"지진파 S파가 통과하지 못하는 것으로 보아 외핵은 액체 상태로 추정되며, 지구 자기장의 원인이 됩니다."},{text:"내핵",isCorrect:false}], hint: "지구 자기장을 만드는 곳입니다." },
            { question: "외권(우주 공간)에서 지구 생명체를 보호하는 역할을 하는 것은?", answerOptions: [{text:"지구 자기장",isCorrect:true,rationale:"지구 자기장은 태양풍이나 우주 방사선과 같은 고에너지 입자를 차단하여 지구 환경을 보호합니다."},{text:"오로라",isCorrect:false},{text:"인공위성",isCorrect:false},{text:"달",isCorrect:false}], hint: "나침반이 북쪽을 가리키게 하는 힘입니다." },

            // [에너지원과 물질 순환]
            { question: "지구 시스템의 에너지원 중 가장 많은 양을 차지하는 것은?", answerOptions: [{text:"지구 내부 에너지",isCorrect:false},{text:"태양 에너지",isCorrect:true,rationale:"태양 에너지는 기상 현상, 해류 발생, 광합성 등 지구상 거의 모든 생명 활동과 변화의 근원입니다."},{text:"조력 에너지",isCorrect:false},{text:"화석 연료",isCorrect:false}], hint: "식물이 광합성을 할 때 필요합니다." },
            { question: "지구 내부 에너지의 주된 발생 원인은?", answerOptions: [{text:"태양 복사열",isCorrect:false},{text:"암석의 마찰열",isCorrect:false},{text:"방사성 동위원소의 붕괴열",isCorrect:true,rationale:"지구 내부의 우라늄, 토륨 등이 붕괴하면서 발생하는 열이 맨틀 대류와 지각 변동의 원동력입니다."},{text:"해수의 순환",isCorrect:false}], hint: "원자력 발전소의 원리와 비슷합니다." },
            { question: "조력 에너지의 주된 원인은?", answerOptions: [{text:"바람",isCorrect:false},{text:"달과 태양의 인력",isCorrect:true,rationale:"달과 태양이 지구를 당기는 인력(기조력)에 의해 밀물과 썰물이 발생합니다."},{text:"지구의 자전",isCorrect:false},{text:"해저 화산",isCorrect:false}], hint: "밀물과 썰물을 만듭니다." },
            { question: "탄소 순환에서 기권의 탄소가 생물권으로 이동하는 과정은?", answerOptions: [{text:"화석 연료의 연소",isCorrect:false},{text:"화산 분출",isCorrect:false},{text:"광합성",isCorrect:true,rationale:"식물(생물권)이 대기 중의 이산화탄소(기권)를 흡수하여 유기물을 만드는 과정입니다."},{text:"호흡",isCorrect:false}], hint: "식물이 양분을 만드는 과정입니다." },
            { question: "탄소 순환에서 직권(지권)에 저장된 탄소가 기권으로 이동하는 과정은?", answerOptions: [{text:"석회암의 생성",isCorrect:false},{text:"화석 연료의 연소",isCorrect:true,rationale:"인간 활동에 의해 땅속의 석탄, 석유를 태우면 이산화탄소가 되어 대기로 방출됩니다."},{text:"광합성",isCorrect:false},{text:"해수의 용해",isCorrect:false}], hint: "공장이나 자동차에서 일어납니다." },
            { question: "물 순환을 일으키는 주된 에너지원은?", answerOptions: [{text:"태양 에너지",isCorrect:true,rationale:"태양열에 의해 물이 증발하여 구름이 되고 비가 내리는 순환이 일어납니다."},{text:"조력 에너지",isCorrect:false},{text:"지구 내부 에너지",isCorrect:false},{text:"풍력 에너지",isCorrect:false}], hint: "증발을 일으키는 힘입니다." },
            { question: "질소 순환에서 대기 중의 질소를 식물이 이용 가능한 형태로 바꾸는 과정은?", answerOptions: [{text:"질소 고정",isCorrect:true,rationale:"뿌리혹박테리아 등이 공기 중의 질소를 암모늄 이온 등으로 바꾸는 것을 질소 고정이라 합니다."},{text:"질소화 작용",isCorrect:false},{text:"탈질산화 작용",isCorrect:false},{text:"호흡",isCorrect:false}], hint: "뿌리혹박테리아가 하는 일입니다." },

            // [판 구조론과 지각 변동]
            { question: "판 구조론에서 '판(Plate)'은 무엇을 말하는가?", answerOptions: [{text:"지각 전체",isCorrect:false},{text:"암석권 (지각 + 상부 맨틀 일부)",isCorrect:true,rationale:"지각과 상부 맨틀의 단단한 부분을 합쳐 암석권이라 하며, 이것이 여러 조각으로 나뉜 것이 판입니다."},{text:"연약권",isCorrect:false},{text:"맨틀 전체",isCorrect:false}], hint: "암석권이라고도 부릅니다." },
            { question: "판을 이동시키는 원동력은?", answerOptions: [{text:"지구 자전",isCorrect:false},{text:"맨틀 대류",isCorrect:true,rationale:"연약권(상부 맨틀)에서의 열 대류가 그 위의 판을 이동시킵니다."},{text:"해류의 이동",isCorrect:false},{text:"태양의 인력",isCorrect:false}], hint: "뜨거운 국물이 끓을 때 도는 현상과 같습니다." },
            { question: "맨틀 대류가 상승하여 판이 서로 멀어지는 경계는?", answerOptions: [{text:"발산형 경계",isCorrect:true,rationale:"새로운 지각이 생성되며 양쪽으로 멀어지는 경계입니다(예: 해령)."},{text:"수렴형 경계",isCorrect:false},{text:"보존형 경계",isCorrect:false},{text:"충돌형 경계",isCorrect:false}], hint: "새로운 땅이 생겨나는 곳입니다." },
            { question: "해양판과 대륙판이 만나 해양판이 아래로 파고드는 곳은?", answerOptions: [{text:"해령",isCorrect:false},{text:"해구(섭입대)",isCorrect:true,rationale:"밀도가 큰 해양판이 밀도가 작은 대륙판 아래로 섭입하여 해구와 습곡 산맥, 화산 등을 만듭니다."},{text:"변환 단층",isCorrect:false},{text:"열곡대",isCorrect:false}], hint: "가장 깊은 바다가 있는 곳입니다." },
            { question: "대륙판과 대륙판이 충돌하여 만들어진 거대한 산맥은?", answerOptions: [{text:"안데스 산맥",isCorrect:false},{text:"히말라야 산맥",isCorrect:true,rationale:"인도 판과 유라시아 판의 충돌로 형성된 대표적인 습곡 산맥입니다."},{text:"로키 산맥",isCorrect:false},{text:"아틀라스 산맥",isCorrect:false}], hint: "에베레스트 산이 있는 곳입니다." },
            { question: "판이 서로 스쳐 지나가며 화산 활동 없이 지진만 주로 발생하는 경계는?", answerOptions: [{text:"발산형 경계",isCorrect:false},{text:"수렴형 경계",isCorrect:false},{text:"보존형 경계",isCorrect:true,rationale:"판이 생성되거나 소멸되지 않고 어긋나게 이동하는 곳으로, 변환 단층이 발달합니다."},{text:"섭입형 경계",isCorrect:false}], hint: "미국의 산안드레아스 단층이 예시입니다." },
            { question: "판의 경계가 아닌 곳에서 마그마가 솟아올라 화산섬(예: 하와이)을 만드는 곳은?", answerOptions: [{text:"열점(Hot Spot)",isCorrect:true,rationale:"판 내부의 고정된 마그마 공급원인 열점 위를 판이 이동하면서 화산섬들이 줄지어 생깁니다."},{text:"해령",isCorrect:false},{text:"해구",isCorrect:false},{text:"습곡 산맥",isCorrect:false}], hint: "판의 한가운데서 뚫고 나옵니다." },
            { question: "지진 발생 시 가장 먼저 도착하는 파동은?", answerOptions: [{text:"S파",isCorrect:false},{text:"P파",isCorrect:true,rationale:"P파(Primary wave)는 속도가 빨라 가장 먼저 도착하며 고체, 액체, 기체를 모두 통과합니다."},{text:"L파",isCorrect:false},{text:"전자기파",isCorrect:false}], hint: "Primary(첫 번째)의 약자입니다." },

            // [상호작용 및 기타]
            { question: "화산 폭발로 분출된 화산재가 기온을 낮추는 것은 어느 권역 간의 상호작용인가?", answerOptions: [{text:"직권 → 기권",isCorrect:true,rationale:"땅(직권)에서 나온 화산재가 대기(기권)를 덮어 햇빛을 차단하기 때문입니다."},{text:"기권 → 직권",isCorrect:false},{text:"수권 → 기권",isCorrect:false},{text:"생물권 → 직권",isCorrect:false}], hint: "땅 속에서 나온 것이 하늘을 가립니다." },
            { question: "바람에 의해 해류가 생기는 것은 어느 권역 간의 상호작용인가?", answerOptions: [{text:"기권 → 수권",isCorrect:true,rationale:"대기의 바람(기권)이 바닷물(수권)을 밀어 해류를 발생시킵니다."},{text:"수권 → 기권",isCorrect:false},{text:"직권 → 수권",isCorrect:false},{text:"생물권 → 수권",isCorrect:false}], hint: "공기가 물을 움직입니다." },
            { question: "식물의 뿌리가 암석을 부수어 토양을 만드는 작용은?", answerOptions: [{text:"생물권 → 직권",isCorrect:true,rationale:"생물의 활동이 암석(직권)의 풍화에 영향을 주는 예시입니다."},{text:"직권 → 생물권",isCorrect:false},{text:"기권 → 직권",isCorrect:false},{text:"수권 → 직권",isCorrect:false}], hint: "생물이 돌을 깹니다." },
            { question: "엘니뇨(El Nino) 현상의 특징으로 옳은 것은?", answerOptions: [{text:"무역풍이 강해진다",isCorrect:false},{text:"동태평양 적도 부근 수온이 평년보다 높아진다",isCorrect:true,rationale:"무역풍 약화로 따뜻한 해수가 동쪽으로 쏠려 동태평양 수온이 상승하는 현상입니다."},{text:"서태평양에 홍수가 난다",isCorrect:false},{text:"용승이 강해진다",isCorrect:false}], hint: "크리스마스의 아기 예수라는 뜻입니다." },
            { question: "지구 온난화의 주된 원인 물질은?", answerOptions: [{text:"산소",isCorrect:false},{text:"질소",isCorrect:false},{text:"이산화탄소",isCorrect:true,rationale:"온실가스인 이산화탄소 농도 증가가 지구 평균 기온 상승의 주원인입니다."},{text:"아르곤",isCorrect:false}], hint: "화석 연료를 태울 때 나옵니다." },
            { question: "밀물과 썰물을 이용하여 전기를 생산하는 방식은?", answerOptions: [{text:"파력 발전",isCorrect:false},{text:"조력 발전",isCorrect:true,rationale:"조석 간만의 차(조력 에너지)를 이용해 터빈을 돌려 전기를 얻습니다."},{text:"수력 발전",isCorrect:false},{text:"지열 발전",isCorrect:false}], hint: "시화호에 설치되어 있습니다." },
            { question: "지구 시스템의 평형을 유지하는 핵심 원리는?", answerOptions: [{text:"물질은 순환하고 에너지는 흐른다",isCorrect:true,rationale:"에너지는 태양에서 들어와 우주로 나가며(흐름), 물질(탄소, 물 등)은 지구 내에서 계속 순환합니다."},{text:"에너지가 순환한다",isCorrect:false},{text:"물질이 우주로 나간다",isCorrect:false},{text:"변화가 전혀 없다",isCorrect:false}], hint: "물질은 돌고 돌지만, 에너지는 들어왔다 나갑니다." }
        ];

        // ==========================================
        // 퀴즈 로직
        // ==========================================
        let currentQuizList = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswered = false;

        function startQuiz() {
            const shuffled = [...questionBank];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            currentQuizList = shuffled.slice(0, 10);

            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('question-area').classList.remove('hidden');
            document.getElementById('total-num').innerText = currentQuizList.length;

            loadQuestion();
        }

        function loadQuestion() {
            isAnswered = false;
            const qData = currentQuizList[currentQuestionIndex];
            
            document.getElementById('current-num').innerText = currentQuestionIndex + 1;
            document.getElementById('question-text').innerText = qData.question;
            document.getElementById('hint-box').innerText = qData.hint;
            document.getElementById('hint-box').classList.add('hidden');
            
            const progress = ((currentQuestionIndex) / currentQuizList.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            const rationaleArea = document.getElementById('rationale-area');
            rationaleArea.classList.add('hidden');
            rationaleArea.classList.remove('bg-green-50', 'bg-red-50', 'border-green-200', 'border-red-200');
            
            const optionsList = document.getElementById('options-list');
            optionsList.innerHTML = '';

            qData.answerOptions.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 transition duration-200 font-medium text-gray-700 flex items-center gap-3 group bg-white`;
                btn.innerHTML = `
                    <span class="w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center group-hover:bg-indigo-200 group-hover:text-indigo-700 transition font-bold text-sm shrink-0">${index + 1}</span>
                    <span class="leading-snug">${option.text}</span>
                `;
                btn.onclick = () => checkAnswer(option, btn, qData.answerOptions);
                optionsList.appendChild(btn);
            });
        }

        function toggleHint() {
            document.getElementById('hint-box').classList.toggle('hidden');
        }

        function checkAnswer(selectedOption, btnElement, allOptions) {
            if (isAnswered) return;
            isAnswered = true;

            const isCorrect = selectedOption.isCorrect;
            const rationale = selectedOption.rationale || "해설이 없습니다.";
            const allButtons = document.getElementById('options-list').children;

            if (isCorrect) {
                score += 10;
                document.getElementById('score-display').innerText = `${score}점`;
                styleButton(btnElement, 'correct');
                showRationale(true, rationale);
            } else {
                styleButton(btnElement, 'wrong');
                const correctIndex = allOptions.findIndex(o => o.isCorrect === true);
                if (correctIndex !== -1) styleButton(allButtons[correctIndex], 'correct-light');
                showRationale(false, rationale);
            }

            for (let btn of allButtons) {
                btn.onclick = null;
                btn.classList.add('cursor-default');
                btn.classList.remove('hover:bg-indigo-50', 'hover:border-indigo-400');
            }
        }

        function styleButton(btn, type) {
            btn.classList.remove('border-gray-200', 'bg-white');
            const iconSpan = btn.querySelector('span:first-child');
            if (type === 'correct') {
                btn.classList.add('border-green-500', 'bg-green-100', 'text-green-900');
                iconSpan.innerHTML = '<i class="fas fa-check"></i>';
                iconSpan.classList.add('bg-green-200', 'text-green-800');
            } else if (type === 'wrong') {
                btn.classList.add('border-red-500', 'bg-red-100', 'text-red-900');
                iconSpan.innerHTML = '<i class="fas fa-times"></i>';
                iconSpan.classList.add('bg-red-200', 'text-red-800');
            } else if (type === 'correct-light') {
                btn.classList.add('border-green-500', 'bg-green-50', 'text-green-800');
            }
        }

        function showRationale(isCorrect, text) {
            const area = document.getElementById('rationale-area');
            const icon = document.getElementById('rationale-icon');
            const title = document.getElementById('rationale-title');
            const body = document.getElementById('rationale-text');
            
            area.classList.remove('hidden');
            if (isCorrect) {
                area.classList.add('bg-green-50', 'border-green-200');
                icon.innerHTML = '<i class="fas fa-check-circle text-green-600"></i>';
                title.innerText = "정답입니다!";
                title.className = 'font-bold text-lg mb-1 text-green-800';
            } else {
                area.classList.add('bg-red-50', 'border-red-200');
                icon.innerHTML = '<i class="fas fa-exclamation-circle text-red-600"></i>';
                title.innerText = "오답입니다.";
                title.className = 'font-bold text-lg mb-1 text-red-800';
            }
            body.innerText = text;
            setTimeout(() => area.scrollIntoView({ behavior: 'smooth', block: 'center' }), 100);
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuizList.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('question-area').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            document.getElementById('progress-bar').style.width = '100%';
        }
    </script>
</body>
</html>