<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI ì†ê¸€ì”¨ í•´ì„¤</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="exam_data_exam_01.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #F3F4F6; }
        
        /* [ìˆ˜ì •] ì†ê¸€ì”¨ ì „ìš© í´ë˜ìŠ¤ + ì¤„ë…¸íŠ¸ ë°°ê²½ */
        .handwriting {
            font-family: 'Nanum Pen Script', cursive;
            font-size: 1.8rem; /* ê¸€ì”¨ í¬ê¸° ì•½ê°„ í‚¤ì›€ */
            color: #2d3748;    /* ì§„í•œ ì—°í•„ìƒ‰ */
        }

        /* [ì‹ ê·œ] ì¤„ë…¸íŠ¸ ë°°ê²½ íš¨ê³¼ CSS */
        .lined-paper {
            background-color: #fffef9; /* ë”°ëœ»í•œ ì•„ì´ë³´ë¦¬ìƒ‰ ì¢…ì´ */
            /* ê°€ë¡œ ì¤„ë¬´ëŠ¬ (ê·¸ë¼ë°ì´ì…˜ ì´ìš©) */
            background-image: linear-gradient(transparent 95%, #e2e8f0 95%); 
            background-size: 100% 2.5rem; /* ì¤„ ê°„ê²© (ê¸€ì”¨ í¬ê¸°ì— ë§ì¶¤) */
            line-height: 2.5rem; /* ì¤„ë†’ì´ë¥¼ ë°°ê²½ ì¤„ ê°„ê²©ê³¼ ì¼ì¹˜ì‹œí‚´ */
            box-shadow: 1px 1px 5px rgba(0,0,0,0.05); /* ì¢…ì´ ì§ˆê° ê·¸ë¦¼ì */
        }

        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* OMR ë²„íŠ¼ í™œì„±í™” íš¨ê³¼ */
        .omr-btn.active {
            background-color: #4F46E5; /* Indigo-600 */
            color: white;
            border-color: #4F46E5;
            transform: scale(1.1);
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.4);
        }
    </style>
</head>
<body class="flex justify-center min-h-screen">

    <div class="w-full max-w-[480px] bg-white flex flex-col h-screen shadow-2xl relative">
        
        <header class="flex items-center px-4 py-3 border-b border-gray-100 bg-white sticky top-0 z-20">
            <button onclick="history.back()" class="p-2 mr-2 rounded-full hover:bg-gray-100 text-gray-600 transition-colors">
                <i data-lucide="arrow-left" class="w-6 h-6"></i>
            </button>
            <div class="flex-1 overflow-hidden">
                <h1 class="text-lg font-bold text-gray-900 truncate" id="exam-title">ëª¨ì˜ê³ ì‚¬ ì œëª© ë¡œë”© ì¤‘...</h1>
                <p class="text-xs text-indigo-600 font-medium">AI Smart Note</p>
            </div>
        </header>

        <div class="bg-gray-50 border-b border-gray-200 px-4 py-3 shrink-0 z-10 shadow-sm">
            <p class="text-[10px] text-gray-400 font-bold mb-2 flex justify-between">
                <span>QUESTION NAVIGATOR</span>
                <span id="progress-text">0 / 25 ì™„ë£Œ</span>
            </p>
            <div class="overflow-x-auto no-scrollbar pb-1">
                <div class="flex gap-2" id="omr-grid" style="min-width: max-content;">
                    </div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto bg-[#FAFAFA] relative" id="viewer-container">
            
            <div id="empty-state" class="h-full flex flex-col items-center justify-center text-center text-gray-400 space-y-4 p-5">
                <div class="w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mb-2 animate-bounce">
                    <i data-lucide="hand-metal" class="w-10 h-10 text-indigo-400"></i>
                </div>
                <p class="text-sm">ìƒë‹¨ ë²ˆí˜¸ë¥¼ ëˆŒëŸ¬<br><span class="font-bold text-indigo-500">ì†ê¸€ì”¨ í•´ì„¤ ë…¸íŠ¸</span>ë¥¼ í™•ì¸í•˜ì„¸ìš”!</p>
            </div>

            <div id="explanation-card" class="hidden p-5 animate-fade-in">
                <div class="flex justify-between items-end mb-3 ml-8 border-b border-gray-300 pb-1 border-dashed">
                    <h2 class="text-3xl font-black text-gray-800" style="font-family: 'Nanum Pen Script';">Q. <span id="q-num">1</span></h2>
                    <span class="text-xs font-bold text-white bg-indigo-500 px-2 py-1 rounded mb-1" id="q-topic">ë‹¨ì› ì •ë³´</span>
                </div>
                
                <div class="relative">
                     <div class="absolute left-6 top-0 bottom-0 w-px bg-red-200 h-full opacity-70 z-10"></div>

                    <div class="handwriting lined-paper pl-10 pr-4 py-4 rounded-r-lg min-h-[400px]">
                        <div id="explanation-content">
                            </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ===========================
        // (Step 2ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ ìœ ì§€)
        // ===========================
        lucide.createIcons();

        let currentExamData = null;
        let selectedQuestionNo = null;

        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const docId = urlParams.get('id') || 'exam_sample';
            await loadExamData(docId);
        });

        async function loadExamData(docId) {
            try {
                // [ìˆ˜ì •ë¨] fetch ëŒ€ì‹  ì „ì—­ ë³€ìˆ˜ì—ì„œ ë°”ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
                // exam_data.js íŒŒì¼ì´ ë¡œë“œë˜ë©´ window.globalExamDataì— ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤.
                if (window.globalExamData) {
                    currentExamData = window.globalExamData;
                } else {
                    // ë°ì´í„° íŒŒì¼ì´ ì—†ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ê°€ì§œ ë°ì´í„° (í…ŒìŠ¤íŠ¸ìš©)
                    console.warn("ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.");
                    currentExamData = generateMockData(); 
                }
                
                // í™”ë©´ ì´ˆê¸° ì„¸íŒ…
                document.getElementById('exam-title').innerText = currentExamData.examInfo.title;
                document.getElementById('progress-text').innerText = `0 / ${currentExamData.examInfo.totalQuestions} í™•ì¸`;
                
                renderOMRGrid();

            } catch (error) {
                console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", error);
                alert("í•´ì„¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
        }

        function renderOMRGrid() {
            const grid = document.getElementById('omr-grid');
            grid.innerHTML = '';
            currentExamData.explanations.forEach(item => {
                const btn = document.createElement('button');
                btn.id = `btn-${item.no}`;
                btn.className = `omr-btn w-10 h-10 rounded-xl border border-gray-200 bg-white text-sm font-bold text-gray-500 flex items-center justify-center shrink-0 transition-all active:scale-95 hover:border-indigo-300`;
                btn.innerText = item.no;
                btn.onclick = () => selectQuestion(item.no);
                grid.appendChild(btn);
            });
        }

        function selectQuestion(no) {
            if (selectedQuestionNo) {
                const prevBtn = document.getElementById(`btn-${selectedQuestionNo}`);
                if(prevBtn) prevBtn.classList.remove('active');
            }
            selectedQuestionNo = no;
            const currBtn = document.getElementById(`btn-${no}`);
            if(currBtn) currBtn.classList.add('active');

            const data = currentExamData.explanations.find(e => e.no === no);
            
            if (data) {
                document.getElementById('empty-state').classList.add('hidden');
                document.getElementById('explanation-card').classList.remove('hidden');

                document.getElementById('q-num').innerText = data.no;
                document.getElementById('q-topic').innerText = data.topic;
                document.getElementById('explanation-content').innerHTML = data.content;
                
                document.getElementById('viewer-container').scrollTop = 0;
            }
        }

        function generateMockData() {
            const explanations = [];
            for (let i = 1; i <= 25; i++) {
                explanations.push({
                    no: i,
                    topic: i % 2 === 0 ? "ì‹œìŠ¤í…œê³¼ ìƒí˜¸ì‘ìš©" : "ë¬¼ì§ˆê³¼ ê·œì¹™ì„±",
                    content: `
                        ì•ˆë…•! <b>${i}ë²ˆ ë¬¸ì œ</b>ë¥¼ í‹€ë ¸êµ¬ë‚˜? ê´œì°®ì•„, ë‹¤ì‹œ ë³´ë©´ ì‰¬ì›Œ.<br>
                        ì´ ë¬¸ì œì˜ í•µì‹¬ì€ <span class="text-red-500">ê·¸ë˜í”„ì˜ ê¸°ìš¸ê¸°</span>ë¥¼ í•´ì„í•˜ëŠ” ê±°ì•¼.<br>
                        Xì¶•ì´ ì‹œê°„ì´ê³  Yì¶•ì´ ì†ë ¥ì´ë‹ˆê¹Œ, ê¸°ìš¸ê¸°ëŠ” ê°€ì†ë„ë¥¼ ì˜ë¯¸í•´.<br><br>
                        ë”°ë¼ì„œ Aêµ¬ê°„ì˜ ê°€ì†ë„ëŠ” 2m/sÂ²ì´ ë˜ëŠ” ê±°ì§€!<br>
                        ë‹¤ìŒì— í’€ ë• <b>ë‹¨ìœ„</b>ë¥¼ ê¼­ í™•ì¸í•˜ì! í™”ì´íŒ…! ğŸ”¥
                    `
                });
            }
            return {
                examInfo: { title: "2026í•™ë…„ë„ í†µí•©ê³¼í•™ ì˜ˆì‹œë¬¸í•­", totalQuestions: 25 },
                explanations: explanations
            };
        }
    </script>
</body>
</html>